!function t(e,n,i){function o(s,u){if(!n[s]){if(!e[s]){var a="function"==typeof require&&require;if(!u&&a)return a(s,!0);if(r)return r(s,!0);var h=new Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var l=n[s]={exports:{}};e[s][0].call(l.exports,function(t){var n=e[s][1][t];return o(n?n:t)},l,l.exports,t,e,n,i)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(t,e,n){function i(t,e){var n=document.createElement("canvas");return n.width=t,n.height=e,n}function o(t,e){this.canvas=i(t,e),this.ctx=this.canvas.getContext("2d"),this._cursor={i:0,j:0},this._paper=0,this._pen=1,this._textColumn=~~(t/4),this._textLine=~~(e/6),this._textOffset=1,this._textPadding=e-6*this._textLine-this._textOffset,this.camera={x:0,y:0},this.ctx.fillStyle=this.palette[0],this.ctx.strokeStyle=this.palette[1]}function r(t,e){for(var n=[219,438,511,14016,14043,14326,14335,28032,28123,28086,28159,32704,32731,32758,32767,128,146,384,402,9344,9362,9600,9618,192,210,448,466,9408,9426,9664,9682,32767,0,8338,45,11962,5588,21157,29354,10,17556,5265,21973,1488,5312,448,13824,5268,31599,29843,29671,31143,18925,31183,31689,18735,31727,18927,1040,5136,17492,3640,5393,8359,25450,23530,31467,25166,15211,29391,4815,27470,23533,29847,15142,23277,29257,23421,23403,11114,4843,26474,23279,14798,9367,27501,12141,24429,23213,14829,29351,25750,17553,13459,9402,28672,34,23530,31467,25166,15211,29391,4815,27470,23533,29847,15142,23277,29257,23421,23403,11114,4843,26474,23279,14798,9367,27501,12141,24429,23213,14829,29351,25686,9362,13587,42,21845],i=0;i<e.length;i++){t.fillStyle=e[i];for(var o=0;o<n.length;o++)for(var r=n[o],s=0;s<15;s++){var u=s%3,a=~~(s/3),h=r>>s&1;1===h&&t.fillRect(3*o+u,5*i+a,1,1)}}t.fillStyle=e[0]}var s=settings.tileSize.width||settings.tileSize[0],u=settings.tileSize.height||settings.tileSize[1],a=16,h=Math.PI/2;e.exports=o,o.prototype._isTexture=!0,o.prototype.palette=["#000000","#FFFFFF"],o.prototype.tilesheet=new o(s*a,u*a),o.prototype.textCharset=new o(384,5*o.prototype.palette.length),o.prototype.resize=function(t,e){return this.canvas.width=t,this.canvas.height=e,this._textColumn=~~(t/4),this._textLine=~~(e/6),this._textOffset=1,this._cursor.i=0,this._cursor.j=0,this.clear(),this},o.prototype.setPalette=function(t){o.prototype.palette=t,o.prototype.textCharset=new o(384,5*t.length),r(o.prototype.textCharset.ctx,t)},o.prototype.setGlobalTilesheet=function(t){o.prototype.tilesheet.clear().draw(t,0,0)},o.prototype.setTilesheet=function(t){return t?(this.tilesheet===o.prototype.tilesheet&&(this.tilesheet=new o(s*a,u*a)),this.tilesheet.clear().draw(t,0,0),this):void delete this.tilesheet},o.prototype.setCamera=function(t,e){return this.camera.x=t||0,this.camera.y=e||0,this},o.prototype.sprite=function(t,e,n,i,o,r){var l=t%a,p=~~(t/a),c=this.ctx;return e=e||0,n=n||0,e=~~Math.round(e-this.camera.x),n=~~Math.round(n-this.camera.y),i||o||r?(c.save(),i&&(c.scale(-1,1),e*=-1,e-=s),o&&(c.scale(1,-1),n*=-1,n-=u),r?(c.translate(e+u,n),c.rotate(h)):c.translate(e,n),c.drawImage(this.tilesheet.canvas,l*s,p*u,s,u,0,0,s,u),c.restore(),this):(c.drawImage(this.tilesheet.canvas,l*s,p*u,s,u,e,n,s,u),this)},o.prototype.draw=function(t,e,n,i,o,r){t._isTileMap&&(t=t.texture.canvas),t._isTexture&&(t=t.canvas);var s=~~Math.round((e||0)-this.camera.x),u=~~Math.round((n||0)-this.camera.y);if(!i&&!o&&!r)return this.ctx.drawImage(t,s,u),this;var a=this.ctx;return a.save(),i&&(a.scale(-1,1),s*=-1,s-=t.width),o&&(a.scale(1,-1),u*=-1,u-=t.height),r?(a.translate(s+t.height,u),a.rotate(h)):a.translate(s,u),a.drawImage(t,0,0),a.restore(),this},o.prototype.clear=function(){return this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this},o.prototype.cls=function(){return this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.locate(0,0),this},o.prototype.pen=function(t){return this._pen=t%this.palette.length,this.ctx.strokeStyle=this.palette[this._pen],this},o.prototype.paper=function(t){return this._paper=t%this.palette.length,this.ctx.fillStyle=this.palette[this._paper],this},o.prototype.rect=function(t,e,n,i){return this.ctx.strokeRect(~~(t-this.camera.x)+.5,~~(e-this.camera.y)+.5,~~(n-1),~~(i-1)),this},o.prototype.rectfill=function(t,e,n,i){return this.ctx.fillRect(~~(t-this.camera.x),~~(e-this.camera.y),~~n,~~i),this},o.prototype.locate=function(t,e){return this._cursor.i=~~t,this._cursor.j=~~e,this},o.prototype.print=function(t,e,n){if("object"==typeof t)try{t=JSON.stringify(t)}catch(e){t="[Object]"}else"string"!=typeof t&&(t=t.toString());if(void 0!==e){e=~~Math.round(e-this.camera.x),n=~~Math.round(n-this.camera.y);for(var i=0;i<t.length;i++)this.ctx.drawImage(this.textCharset.canvas,3*t.charCodeAt(i),5*this._pen,3,5,e,n,3,5),e+=4;return this}for(var i=0;i<t.length;i++){this._cursor.j>=this._textLine&&this.textScroll();var o=t.charCodeAt(i);10!==o&&13!==o?(this.ctx.drawImage(this.textCharset.canvas,3*o,5*this._pen,3,5,4*this._cursor.i,6*this._cursor.j+this._textOffset,3,5),this._cursor.i+=1,this._cursor.i>this._textColumn&&(this._cursor.i=0,this._cursor.j+=1)):(this._cursor.i=0,this._cursor.j+=1)}return this},o.prototype.println=function(t){return this.print(t),this.print("\n"),this},o.prototype.textScroll=function(t){return void 0===t&&(t=1),this._cursor.j-=t,t*=6,this.ctx.drawImage(this.canvas,0,-t),this.ctx.fillRect(0,this.canvas.height-t-this._textPadding,this.canvas.width,t+this._textPadding),this}},{}],2:[function(t,e,n){function i(t,e,n,i,o,r,s,u){this.x=~~t,this.y=~~e,this.sprite=~~n,this.flipH=!!i,this.flipV=!!o,this.flipR=!!r,this.flagA=!!s,this.flagB=!!u}function o(t,e){this._name="",this.width=0,this.height=0,this.items=[],this.texture=new r(t*s,e*u),this.tilesheet=null,this._tilesheetPath="",t&&e&&this._init(t,e)}var r=t("../Texture"),s=settings.tileSize.width||settings.tileSize[0],u=settings.tileSize.height||settings.tileSize[1];i.prototype.draw=function(t){t.sprite(this.sprite,this.x*s,this.y*u,this.flipH,this.flipV,this.flipR)},e.exports=o,o.prototype._isTileMap=!0;var a={},h=[];o.getMap=function(t){return"string"==typeof t?a[t]:"number"==typeof t?h[t]:(console.error("Map does not exist",t),null)},o._checkBankFormat=function(t){return t?Array.isArray(t)?{_type:"maps",maps:t}:"maps"!==t._type?(console.warn("Map bank format incorrect"),{_type:"maps",maps:[]}):t:(console.warn("No map bank"),{_type:"maps",maps:[]})},o.loadBank=function(t){t=o._checkBankFormat(t);for(var e=[],n=t.maps||[],i=0;i<n.length;i++)e.push((new o).load(n[i]))},Object.defineProperty(o.prototype,"name",{get:function(){return this._name},set:function(t){this._name&&a[this._name]&&a[this._name]===this&&delete a[this._name],this._name=t,t&&!a[t]&&(a[t]=this)}}),o.prototype._init=function(t,e){this.texture.resize(t*s,e*u),this.width=t,this.height=e,this.items=[];for(var n=0;n<t;n++){this.items.push([]);for(var i=0;i<e;i++)this.items[n][i]=null}},o.prototype.resize=function(t,e){var n=this.items,i=Math.min(this.width,t),o=Math.min(this.height,e);this.texture.resize(t*s,e*u),this._init(t,e);for(var r=0;r<i;r++)for(var a=0;a<o;a++)this.items[r][a]=n[r][a];return this.redraw(),this},o.prototype.set=function(t,e,n,o,r,a,h,l){if(null===n||void 0===n)return this.remove(t,e);if(!(t<0||e<0||t>=this.width||e>=this.height)){var p=this.items[t][e]=new i(t,e,n,o,r,a,h,l);return this.texture.ctx.clearRect(t*s,e*u,s,u),p.draw(this.texture),this}},o.prototype.remove=function(t,e){if(!(t<0||e<0||t>=this.width||e>=this.height))return this.items[t][e]=null,this.texture.ctx.clearRect(t*s,e*u,s,u),this},o.prototype.get=function(t,e){return t<0||e<0||t>=this.width||e>=this.height?null:this.items[t][e]},o.prototype.redraw=function(){this.texture.clear();for(var t=0;t<this.width;t++)for(var e=0;e<this.height;e++)this.items[t][e]&&this.items[t][e].draw(this.texture);return this},o.prototype.draw=function(t,e){draw(this.texture,t,e)},o.prototype.setTilesheet=function(t){return this.tilesheet=t,this._tilesheetPath=t&&t.path||"",this.texture.setTilesheet(t),this.redraw(),this},o.prototype._setTilesheetPath=function(t){if(this._tilesheetPath=t||"",!t)return this.setTilesheet();t=t.split("/"),fileId=t.pop();for(var e=window.assets||{},n=0;n<t.length;n++)if(e=e[t[n]],!e)return console.warn("Could not find tilesheet",t);var i=e[fileId];i&&i instanceof Image&&this.setTilesheet(i)};var l,p;!function(){function t(t){var n=~~(t/o),i=t%o;return e[n]+e[i]}for(var e="#$%&'()*+,-~/0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstuvwxyz{|}. !",n={},i=0;i<e.length;i++)n[e[i]]=i;var o=e.length,r=o*o-1,s=Math.pow(2,13),u=r-s-1;l=function(e){str="",count=0;for(var n=0;n<e.length;n++){var i=e[n];i===e[n+1]&&++count<u||(null===i&&(i=r),str+=t(i),count===u&&count--,0!==count&&(str+=t(s+count)),count=0)}return count===u&&count--,0!==count&&(str+=t(s+count)),str},p=function(t){arr=[];for(var e=0;e<t.length;){var i=t[e++],u=t[e++],a=n[i]*o+n[u];if(a===r)arr.push(null);else if(a>s)for(var h=a-s,l=arr[arr.length-1],p=0;p<h;p++)arr.push(l);else arr.push(a)}return arr}}(),o.prototype.save=function(){for(var t=this.width,e=this.height,n=new Array(t*e),i=0;i<t;i++)for(var o=0;o<e;o++){var r=this.items[i][o];n[i+o*t]=r?r.sprite+(r.flipH<<8)+(r.flipV<<9)+(r.flipR<<10)+(r.flagA<<11)+(r.flagB<<12):null}var s={w:t,h:e,name:this.name,sheet:this._tilesheetPath||"",data:l(n)};return s},o.prototype.load=function(t){var e=t.w,n=t.h;this._init(e,n),this.name=t.name||"",this._setTilesheetPath(t.sheet);for(var i=p(t.data),o=0;o<e;o++)for(var r=0;r<n;r++){var s=i[o+r*e];if(null!==s){var u=255&s,a=s>>8&1,h=s>>9&1,l=s>>10&1,c=s>>11&1,d=s>>12&1;this.set(o,r,u,a,h,l,c,d)}}return this.redraw(),this},o.prototype.copy=function(t,e,n,i){t=t||0,e=e||0,void 0!==n&&null!==n||(n=this.width),void 0!==i&&null!==i||(i=this.height);var r=new o(n,i);return r.paste(this,-t,-e),r},o.prototype.paste=function(t,e,n,i){e=e||0,n=n||0;for(var o=Math.min(t.width,this.width-e),r=Math.min(t.height,this.height-n),s=Math.max(0,-e),u=Math.max(0,-n),a=s;a<o;a++)for(var h=u;h<r;h++){var l=t.items[a][h];if(l)this.set(a+e,h+n,l.sprite,l.flipH,l.flipV,l.flipR,l.flagA,l.flagB);else{if(i)continue;this.remove(a+e,h+n)}}return this.redraw(),this},o.prototype.clear=function(){for(var t=0;t<this.width;t++)for(var e=0;e<this.height;e++)this.items[t][e]=null;return this.texture.clear(),this},o.prototype.find=function(t,e,n){if(null===t)return this._findNull();void 0===e&&(e=null),void 0===n&&(n=null);for(var i=[],o=0;o<this.width;o++)for(var r=0;r<this.height;r++){var s=this.items[o][r];if(s){var u=null===e||s.flagA===e,a=null===n||s.flagB===n;s.sprite===t&&u&&a&&i.push(s)}}return i},o.prototype._findNull=function(){for(var t=[],e=0;e<this.width;e++)for(var n=0;n<this.height;n++)null===this.items[e][n]&&t.push({x:e,y:n});return t}},{"../Texture":1}],3:[function(t,e,n){function i(t,e,n){var i=new XMLHttpRequest;i.responseType=e||"arraybuffer",i.onreadystatechange=function(){if(4===~~i.readyState)return 200!==~~i.status&&0!==~~i.status?n&&n("xhrError:"+i.status):n&&n(null,i.response)},i.open("GET",t,!0),i.send()}function o(t,e){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4===~~n.readyState)return 200!==~~n.status?e("xhrError:"+n.status):e&&e(null,JSON.parse(n.response))},n.open("GET",t,!0),n.send()}function r(t,e){var n=new XMLHttpRequest;n.open("POST","req",!0),n.setRequestHeader("Content-Type","application/json; charset=UTF-8"),n.onreadystatechange=function(){if(4===~~n.readyState){if(200!==~~n.status)return e&&e("xhr:"+n.status);var t=JSON.parse(n.response);return e&&e(t.error,t.result)}},n.send(JSON.stringify(t))}function s(t,e){var n=new Image;n.onload=function(){this.onload=null,this.onerror=null,e&&e(null,this)},n.onerror=function(){this.onload=null,this.onerror=null,e&&e("img:"+t)},n.src=t}function u(t,e){function n(){e&&e(null,o),o.removeEventListener("canplaythrough",n),o.removeEventListener("error",i)}function i(){e&&e("snd:load"),o.removeEventListener("canplaythrough",n),o.removeEventListener("error",i)}var o=new Audio;o.preload=!0,o.loop=!1,o.addEventListener("canplaythrough",n),o.addEventListener("error",i),o.src=t,o.load()}function a(t,e,n){function i(t,e){var n=t.split("/"),i=n.pop(),o=i.split(".");o.pop(),o=o.join(".");for(var s=r,u=0,a=n.length;u<a;u++)s=s[n[u]];s[o]=e,n.push(o),e.name=o,e.path=n.join("/")}function o(){var d=p+c,f=d/h;n&&n(p,d,h,f);var v,y;d<a?(v=t.img[d],y=s):(v=t.snd[d-a],y=u),c+=1,y(l+v,function(t,n){t||i(v,n),p+=1,c-=1,p+c<h?o():0===c&&e(null,r)})}var r=t.dat,a=t.img.length,h=a+t.snd.length,l=t.root,p=0,c=0;if(0===h)return e(null,r);for(var d=Math.min(5,h-1),f=0;f<=d;f++)o()}n.loadData=i,n.loadJson=o,n.sendRequest=r,n.loadImage=s,n.loadSound=u,n.preloadStaticAssets=a},{}],4:[function(t,e,n){function i(t){this.id=t,this.volume=1,this.muted=!0,this.loopSound=null,this.loopId=null,this.loopVol=0,this.nextLoop=null}e.exports=i,i.prototype.setVolume=function(t,e){var n=this.muted;this.muted=0===t||e||!1,void 0!==t&&null!==t?this.volume=t:t=this.volume,this.loopId&&(this.loopSound&&this.muted?this.loopSound.stop():this.loopSound&&this.loopSound.id===this.loopId?(this.loopSound.setVolume(Math.max(0,Math.min(1,t*this.loopVol))),n&&this.loopSound.play()):this.muted||this.audioManager.playLoopSound(this.id,this.loopId,this.loopVol))},i.prototype.setMute=function(t){this.setVolume(null,t)},i.prototype.playLoopSound=function(t,e,n,i,o,r){function s(t,e){return t?void(t.stopping||t.stop(function(){return h.freeSound(t),t=null,e&&e()})):e&&e()}function u(){var t=f.loopSound=f.nextLoop;f.nextLoop=null,t&&(t.setLoop(!0,o,r),t.fade=l,t.load(function(o){return o?(t.unload(),void(f.loopSound=null)):void t.play(e*f.volume,n,i)}))}function a(){f.loopSound=null,window.setTimeout(u,0)}var h=this.audioManager,l=h.settings.defaultFade,p=h.settings.crossFading,c=this.loopSound,d=c&&c.id;if(e=Math.max(0,Math.min(1,e||1)),this.loopId=t,this.loopVol=e,!h.muted&&!this.muted){if(t===d&&c)return c.play(e*this.volume,n,i),void(this.nextLoop&&(this.nextLoop.cancelOnLoadCallbacks(),this.nextLoop=null));if(c=null,!this.nextLoop||this.nextLoop.id!==t){var f=this;p?(this.nextLoop&&this.nextLoop.cancelOnLoadCallbacks(),this.nextLoop=h.createSound(t,this.id),this.nextLoop.load(function(t){return t?(f.nextLoop.unload(),void(f.nextLoop=null)):(s(f.loopSound),void a())})):(this.nextLoop=h.createSound(t,this.id),s(this.loopSound,a))}}}},{}],5:[function(t,e,n){function i(t){this.soundsById={},this.soundGroupsById={},this.permanentSounds={},this.freeSoundPool=[],this.soundArchive=new r(function(){return 1}),this.soundGroupArchive=new r(function(){return 1}),this.soundArchiveById={},this.soundGroupArchiveById={},this.usedMemory=0,this.channels={},this.audioContext=null,this.muted=!1,this.settings={audioPath:"",maxSoundGroup:500,maxUsedMemory:300,defaultFade:2,maxPlayLatency:1e3,crossFading:!1,getFileUri:function(t,e){return t+e+".mp3"},getSoundConstructor:function(t,e){return null}};for(var e=0;e<t.length;e++){var n=t[e];this.channels[n]=new a(n)}h.prototype.audioManager=this,u.prototype.audioManager=this,a.prototype.audioManager=this}var o=window.AudioContext||window.webkitAudioContext,r=t("./OrderedList"),s=t("./SoundBuffered.js"),u=t("./SoundGroup.js"),a=t("./AudioChannel.js"),h=t("./ISound.js");o||(console.warn("Web Audio API is not supported on this platform. Fallback to regular HTML5 <Audio>"),s=t("./Sound.js"),window.Audio||(console.warn("HTML5 <Audio> is not supported on this platform. Sound features are unavailable."),s=h)),e.exports=i,e.exports.ISound=h,i.prototype.init=function(){if(!this.audioContext&&o){this.audioContext=new o,s.prototype.audioContext=this.audioContext;for(var t in this.soundsById)this.soundsById[t].init()}},i.prototype.getEmptySound=function(t,e){var n,i=this.settings.getSoundConstructor(t,e);return i?n=new i:(this.freeSoundPool.length>0?(n=this.freeSoundPool.pop(),n.init()):n=new s,n)},i.prototype.setup=function(t){for(var e in t){var n=t[e];this.setVolume(e,n.volume,n.muted)}},i.prototype.addChannel=function(t){this.channels[t]||(this.channels[t]=new a(t))},i.prototype.setVolume=function(t,e,n){var i=this.channels[t];i&&i.setVolume(e,n)},i.prototype.setMute=function(t){void 0===t&&(t=!this.muted),this.muted=!!t;for(var e in this.channels){var n=this.channels[e];if(n.loopSound)if(t)n.loopSound.stop();else{var i=n.muted;n.muted=!0,n.setVolume(null,i)}}},i.prototype.loadSound=function(t,e){var n=this.createSound(t);return n.load(e),n},i.prototype.createSound=function(t,e){var n=this.getSound(t);return n?n:(n=this.soundsById[t]=this.getEmptySound(e,t),n.setId(t),n)},i.prototype.createSoundPermanent=function(t,e){var n=this.getSound(t);if(n)return n;var i=this.settings.getSoundConstructor(e,t)||s;return n=this.permanentSounds[t]=new i,n.setId(t),n},i.prototype.getSound=function(t){var e=this.permanentSounds[t];return e?e:(e=this.soundsById[t])?e:(e=this.soundArchiveById[t])?(this.soundArchive.removeByRef(e.poolRef),e.poolRef=null,delete this.soundArchiveById[t],this.soundsById[t]=e,e):null},i.prototype.getSoundGroup=function(t){var e=this.soundGroupsById[t];return e?e:(e=this.soundGroupArchiveById[t])?(this.soundGroupArchive.removeByRef(e.poolRef),e.poolRef=null,delete this.soundGroupArchiveById[t],e.verifySounds(),this.soundGroupsById[t]=e,e):null},i.prototype.freeSound=function(t){var e=t.id;this.soundsById[e]&&delete this.soundsById[e],this.soundArchiveById[e]&&(this.soundArchive.removeByRef(t.poolRef),t.poolRef=null,delete this.soundArchiveById[e]),t.unload(),t instanceof s&&this.freeSoundPool.push(t)},i.prototype.playLoopSound=function(t,e,n,i,o,r,s){var u=this.channels[t];return u?void u.playLoopSound(e,n,i,o,r,s):console.warn('Channel id "'+t+'" does not exist.')},i.prototype.stopLoopSound=function(t){var e=this,n=this.channels[t];if(!n)return console.warn('Channel id "'+t+'" does not exist.');var i=n.loopSound;n.loopId=null,i&&i.stop(function(){e.freeSound(i),n.loopSound=null})},i.prototype.stopAllLoopSounds=function(){for(var t in this.channels)this.stopLoopSound(t)},i.prototype.release=function(){var t,e,n,i=this.settings.maxSoundGroup,o=this.settings.maxUsedMemory,r={};for(t in this.channels){var s=this.channels[t];s.loopSound&&(r[s.loopSound.id]=!0)}for(t in this.soundGroupsById)e=this.soundGroupsById[t],e.poolRef=this.soundGroupArchive.add(e),this.soundGroupArchiveById[t]=e,delete this.soundGroupsById[t];for(t in this.soundsById)r[t]||(n=this.soundsById[t],n.poolRef=this.soundArchive.add(n),this.soundArchiveById[t]=n,delete this.soundsById[t]);for(var u=this.soundGroupArchive.getCount();u>i&&(e=this.soundGroupArchive.popFirst());)e.poolRef=null,delete this.soundGroupArchiveById[e.id],u-=1;for(;this.usedMemory>o&&(n=this.soundArchive.popFirst());)n.poolRef=null,delete this.soundArchiveById[n.id],this.freeSound(n)},i.prototype.playSound=function(t,e,n,i,o){if(!this.muted){var r=this.channels[t];if(!r.muted){var s=this.getSound(e);s||(s=this.createSound(e,t)),n=n||1,s.play(r.volume*n,i,o)}}},i.prototype.playSoundGroup=function(t,e,n,i,o){if(!this.muted){var r=this.channels[t];if(r&&!r.muted){var s=this.getSoundGroup(e);if(!s)return console.warn('SoundGroup "'+e+'" does not exist.');n=n||1,s.play(n*r.volume,i,o)}}},i.prototype.createSoundGroup=function(t,e,n){if(!this.getSoundGroup(t)){var i=new u(t,e.id,e.vol,e.pitch,n);this.soundGroupsById[t]=i}},i.prototype.createSoundGroups=function(t,e){var n=void 0!==e&&this.channels[e].muted;for(var i in t)this.createSoundGroup(i,t[i],n)}},{"./AudioChannel.js":4,"./ISound.js":6,"./OrderedList":7,"./Sound.js":8,"./SoundBuffered.js":9,"./SoundGroup.js":10}],6:[function(t,e,n){function i(){this.playing=!1,this.stopping=!1,this.fade=0,this.usedMemory=0,this.poolRef=null,this.id=null,this.volume=1,this.pan=0,this.loop=!1,this.pitch=0,this._loaded=!1,this._loading=!1,this._unloading=!1,this._playTriggered=0,this._onLoadQueuedCallback=[]}e.exports=i,i.prototype.setId=function(t){this.id=t,this._loaded=!1},i.prototype.load=function(t){return this.id?this._loaded?t&&t(null,this):(t&&this._onLoadQueuedCallback.push(t),this._loading?void 0:(this._loading=!0,this._load())):t&&t("noId")},i.prototype._finalizeLoad=function(t){var e=this.audioManager.settings.maxPlayLatency;this._loaded=!t,this._loading=!1;for(var n=0;n<this._onLoadQueuedCallback.length;n++)this._onLoadQueuedCallback[n](t,this);return this._onLoadQueuedCallback=[],this._unloading?(this._unloading=!1,void this.unload()):void(this._loaded&&this._playTriggered&&((this.loop||Date.now()-this._playTriggered<e)&&this._play(),this._playTriggered=0))},i.prototype.cancelOnLoadCallbacks=function(){this._onLoadQueuedCallback=[]},i.prototype.play=function(t,e,n){return void 0!==t&&null!==t&&this.setVolume(t),void 0!==e&&null!==e&&this.setPan(e),this._loaded?this.loop&&this.playing?void this._updatePlayPitch(n):void this._play(n):(this._playTriggered=Date.now(),void this.load())},i.prototype.init=function(){},i.prototype.setVolume=function(t){this.volume=t},i.prototype.setPan=function(t){this.pan=t},i.prototype.setLoop=function(t){this.loop=t},i.prototype.setPitch=function(t){this.pitch=t},i.prototype._updatePlayPitch=function(t){},i.prototype._play=function(t){this.playing=!0,console.log('ISound play call: "'+this.id+'"')},i.prototype.stop=function(t){return this.playing=!1,t&&t()},i.prototype._load=function(){return console.log("ISound load call: "+this.id),this._finalizeLoad(null)},i.prototype.unload=function(){return this._playTriggered=0,this.setLoop(!1),this.fade=0,this.pitch=0,this.stop(),this._loading?(this._unloading=!0,!1):(this.audioManager.usedMemory-=this.usedMemory,this.setVolume(1),this.setPan(0),this.id=null,this._loaded=!1,this.usedMemory=0,!0)}},{}],7:[function(t,e,n){function i(t,e,n,i){this.object=t,this.previous=e,this.next=n,this.container=i}function o(t){this.count=0,this.first=null,this.last=null,this.cmpFunc=t}o.prototype.add=function(t){var e=new i(t,null,null,this);if(this.count+=1,null===this.first)return this.first=e,this.last=e,e;var n=this.cmpFunc(t,this.first.object);if(n<0)return e.next=this.first,this.first.previous=e,this.first=e,e;var o=this.cmpFunc(t,this.last.object);if(o>=0)return e.previous=this.last,this.last.next=e,this.last=e,e;var r;if(n+o<0){for(r=this.first.next;this.cmpFunc(t,r.object)>=0;)r=r.next;e.next=r,e.previous=r.previous,e.previous.next=e,r.previous=e}else{for(r=this.last.previous;this.cmpFunc(t,r.object)<0;)r=r.previous;e.previous=r,e.next=r.next,e.next.previous=e,r.next=e}return e},o.prototype.removeByRef=function(t){return!(!t||t.container!==this)&&(this.count-=1,null===t.previous?this.first=t.next:t.previous.next=t.next,null===t.next?this.last=t.previous:t.next.previous=t.previous,t.previous=null,t.next=null,t.container=null,!0)},o.prototype.moveToTheBeginning=function(t){return!(!t||t.container!==this)&&(null===t.previous||(t.previous.next=t.next,this.last===t?this.last=t.previous:t.next.previous=t.previous,t.previous=null,t.next=this.first,t.next.previous=t,this.first=t,!0))},o.prototype.moveToTheEnd=function(t){return!(!t||t.container!==this)&&(null===t.next||(t.next.previous=t.previous,this.first===t?this.first=t.next:t.previous.next=t.next,t.next=null,t.previous=this.last,t.previous.next=t,this.last=t,!0))},o.prototype.possess=function(t){return t&&t.container===this},o.prototype.popFirst=function(){var t=this.first;if(!t)return null;this.count-=1;var e=t.object;return this.first=t.next,null!==this.first&&(this.first.previous=null),t.next=null,t.container=null,e},o.prototype.popLast=function(){var t=this.last;if(!t)return null;this.count-=1;var e=t.object;return this.last=t.previous,null!==this.last&&(this.last.next=null),t.previous=null,t.container=null,e},o.prototype.getFirst=function(){return this.first&&this.first.object},o.prototype.getLast=function(){return this.last&&this.last.object},o.prototype.clear=function(){for(var t=this.first;t;t=t.next)t.container=null;this.count=0,this.first=null,this.last=null},o.prototype.getCount=function(){return this.count},o.prototype.forEach=function(t,e){for(var n=this.first;n;n=n.next)t(n.object,e)},o.prototype.forEachReverse=function(t,e){for(var n=this.last;n;n=n.previous)t(n.object,e)},o.prototype.reposition=function(t){if(t.container!==this)return this.add(t.object);var e=t.previous,n=t.next,i=t.object;for(null===n?this.last=e:n.previous=e,null===e?this.first=n:e.next=n;null!==e&&this.cmpFunc(i,e.object)<0;)n=e,e=e.previous;for(;null!==n&&this.cmpFunc(i,n.object)>=0;)e=n,n=n.next;return t.next=n,null===n?this.last=t:n.previous=t,t.previous=e,null===e?this.first=t:e.next=t,t},e.exports=o},{}],8:[function(t,e,n){function i(){r.call(this);var t=new Audio;t.loop=!1,t.type="audio/mpeg",this._audio=t,this.audioContext&&(this.source=this.audioContext.createMediaElementSource(t),this.source.connect(this.audioContext.destination))}var o=t("util").inherits,r=t("./ISound.js"),s={playAudioWhenScreenIsLocked:!1};o(i,r),e.exports=i,i.prototype.setVolume=function(t){this.volume=this._audio.volume=t},i.prototype.setLoop=function(t){this.loop=this._audio.loop=t},i.prototype._load=function(){function t(t){o._finalizeLoad(t)}function e(){this.removeEventListener("canplaythrough",e),this.removeEventListener("error",n),o.usedMemory=this.duration,o.audioManager.usedMemory+=this.duration,o._finalizeLoad(null)}function n(i){this.removeEventListener("canplaythrough",e),this.removeEventListener("error",n),t(i)}function i(t){o._loading=!0,o._audio.addEventListener("canplaythrough",e),o._audio.addEventListener("error",n),o._audio.src=t,o._audio.load()}var o=this,r=this.audioManager.settings.getFileUri,s=this.audioManager.settings.audioPath;if(r.length>2)r(s,this.id,function(e,n){return e?t(e):void i(n)});else try{var u=r(s,this.id);if(!u)return t("emptyUri");i(u)}catch(e){t(e)}},i.prototype.unload=function(){r.prototype.unload.call(this)&&(this._audio.volume=1,this._audio.src="",this._audio.load())},i.prototype._play=function(t){this._audio.volume=this.volume,this._audio.pause(),this._audio.currentTime=0,this._audio.play(s),this.playing=!0},i.prototype.stop=function(t){return this._audio.pause(),this._audio.currentTime=0,this._playTriggered=0,this.playing=!1,t&&t()}},{"./ISound.js":6,util:24}],9:[function(t,e,n){function i(){r.call(this),this.buffer=null,this.source=null,this.sourceConnector=null,this.gain=null,this.panNode=null,this.rawAudioData=null,this._playPitch=0,this._fadeTimeout=null,this._onStopCallback=null,this._audioNodeReady=!1,this._loopStart=0,this._loopEnd=0,this.init()}var o=t("util").inherits,r=t("./ISound.js"),s=1e-6;o(i,r),e.exports=i,i.prototype._createAudioNodes=function(){if(!this._audioNodeReady&&this.audioContext){var t,e=this.audioContext,n=e.createGain();t=e.createStereoPanner?e.createStereoPanner():e.createPanner(),n.connect(t),t.connect(e.destination),n.gain.value=0,this.sourceConnector=n,this.gain=n.gain,this.panNode=t,this._audioNodeReady=!0}},i.prototype._destroyAudioNodes=function(){if(this._audioNodeReady){var t=this.audioContext,e=this.panNode,n=this.sourceConnector;n.disconnect(e),e.disconnect(t.destination),this.source&&(this.source.disconnect(n),this.source.onended=null,this.source=null),this.sourceConnector=null,this.gain=null,this.panNode=null,this.rawAudioData=null,this._audioNodeReady=!1}},i.prototype.init=function(){function t(t){n.buffer=t,n.usedMemory=t.duration,n.audioManager.usedMemory+=t.duration,n.rawAudioData=null,n._loaded&&n._playTriggered&&((n.loop||Date.now()-n._playTriggered<i)&&n._play(),n._playTriggered=0)}function e(){console.error("decode audio failed for sound ",n.id)}if(this._createAudioNodes(),this.rawAudioData){var n=this,i=this.audioManager.settings.maxPlayLatency,o=this.audioContext;o.decodeAudioData(this.rawAudioData,t,e)}},i.prototype.setVolume=function(t){if(this.volume=t,this.playing){if(!this.fade)return void(this.gain.value=t);t<=0&&(t=s);var e=this.audioContext.currentTime;this.gain.cancelScheduledValues(e),this.gain.setValueAtTime(this.gain.value||s,e),this.gain.linearRampToValueAtTime(t,e+this.fade)}},i.prototype.setPan=function(t){this.pan=t,this.panNode&&(this.panNode.pan?this.panNode.pan.value=t:this.panNode.setPosition(t,0,.2))},i.prototype.setLoop=function(t,e,n){this.loop=!!t,this._loopStart=e||0,this._loopEnd=n||0,this.source&&this.buffer&&(this.source.loop=t,this._setLoopPoints())},i.prototype._setLoopPoints=function(){this.source.loopStart=this._loopStart||0;var t=this._loopEnd;t<0&&(t=this.buffer.duration+t),t<0&&(t=0),this.source.loopEnd=t||this.buffer.duration},i.prototype.setPitch=function(t,e){this.pitch=t,this._setPlaybackRate(e)},i.prototype._updatePlayPitch=function(t){!t&&0!==t||t===this._playPitch||(this._playPitch=t,this._setPlaybackRate(0))},i.prototype._setPlaybackRate=function(t){if(this.source){var e=Math.pow(2,(this._playPitch+this.pitch)/12);if(!t)return void(this.source.playbackRate.value=e);var n=this.audioContext.currentTime;this.source.playbackRate.cancelScheduledValues(n),this.source.playbackRate.setValueAtTime(this.source.playbackRate.value||s,n),this.source.playbackRate.linearRampToValueAtTime(e,n+t)}},i.prototype._load=function(){function t(t){i._finalizeLoad(t)}function e(t){i.buffer=t,i.usedMemory=t.duration,i.audioManager.usedMemory+=t.duration,i._finalizeLoad(null)}function n(n){var o=new XMLHttpRequest;o.responseType="arraybuffer",o.onreadystatechange=function(){if(4===~~o.readyState)return 200!==~~o.status&&0!==~~o.status?t("xhrError:"+o.status):void(i.audioContext?i.audioContext.decodeAudioData(o.response,e,t):(i.rawAudioData=o.response,i._finalizeLoad(null)))},o.open("GET",n,!0),o.send()}var i=this;this._createAudioNodes();var o=this.audioManager.settings.getFileUri,r=this.audioManager.settings.audioPath;if(o.length>2)o(r,this.id,function(e,i){return e?t(e):void n(i)});else try{var s=o(r,this.id);if(!s)return t("emptyUri");n(s)}catch(e){t(e)}},i.prototype.unload=function(){r.prototype.unload.call(this)&&(this._fadeTimeout&&(this._onStopCallback=null,this._stopAndClear()),this.buffer=null,this.source&&(this.source.onended=null,this.source.stop(0),this.source=null),this._destroyAudioNodes())},i.prototype._play=function(t){if(!this.buffer)return void(this._playTriggered=Date.now());this.playing=!0;var e=this.audioContext.currentTime;if(this.gain.cancelScheduledValues(e),this.fade?(this.gain.setValueAtTime(this.gain.value||s,e),this.gain.linearRampToValueAtTime(this.volume||s,e+this.fade)):this.gain.value=this.volume,this._fadeTimeout)return this._onStopCallback=null,this.source.onended=null,this.stopping=!1,window.clearTimeout(this._fadeTimeout),void(this._fadeTimeout=null);this.source&&(this.source.disconnect(this.sourceConnector),this.source.onended=null);var n=this.source=this.audioContext.createBufferSource();n.connect(this.sourceConnector);var i=this;n.onended=function(){i.playing=!1,n.onended=null,i.source=null},this._playPitch=t||0,(t||this.pitch)&&this._setPlaybackRate(0),n.loop=this.loop,n.buffer=this.buffer,this._setLoopPoints(),n.start(0)},i.prototype._stopAndClear=function(){this.stopping=!1,this.source.onended=null,this.source.stop(0),this.source=null,this._fadeTimeout&&(window.clearTimeout(this._fadeTimeout),this._fadeTimeout=null),this._onStopCallback&&(this._onStopCallback(),this._onStopCallback=null)},i.prototype.stop=function(t){if(!this.playing&&!this.stopping)return t&&t();if(this._playTriggered=0,this.stopping=!0,this.playing=!1,!this.source)return t&&t();if(this._onStopCallback=t,!this._fadeTimeout){if(this.fade){var e=this,n=this.audioContext.currentTime;return this.gain.cancelScheduledValues(n),this.gain.setValueAtTime(this.gain.value||s,n),this.gain.linearRampToValueAtTime(s,n+this.fade),void(this._fadeTimeout=window.setTimeout(function(){e._fadeTimeout=null,e._stopAndClear()},1e3*this.fade))}this._stopAndClear()}}},{"./ISound.js":6,util:24}],10:[function(t,e,n){function i(t,e,n,i,o){this.id=t,this.soundIds=e,this.volumes=n||[],this.pitches=i||[],this.soundIndex=0,this.volIndex=0,this.pitchIndex=0,this.poolRef=null,this._ready=!1,0===this.volumes.length&&this.volumes.push(1),0===this.pitches.length&&this.pitches.push(0),
o||this._createSounds()}e.exports=i,i.prototype._createSounds=function(){for(var t=this.soundIds,e=0;e<t.length;e++)this.audioManager.loadSound(t[e]);this._ready=!0},i.prototype.play=function(t,e,n){if(0!==this.soundIds.length){this._ready||this._createSounds();var i=this.soundIds[this.soundIndex++],o=this.audioManager.getSound(i);if(!o)return console.warn("[Sound Group: "+this.id+"] sound id "+i+"  cannot be played.");t=t||1,n=n||0,t*=this.volumes[this.volIndex++],n+=this.pitches[this.pitchIndex++],o.play(t,e,n),this.soundIndex>=this.soundIds.length&&(this.soundIndex=0),this.volIndex>=this.volumes.length&&(this.volIndex=0),this.pitchIndex>=this.pitches.length&&(this.pitchIndex=0)}},i.prototype.verifySounds=function(){for(var t=0;t<this.soundIds.length;t++){var e=this.soundIds[t];this.audioManager.createSound(e)}}},{}],11:[function(t,e,n){function i(t,e){function n(e){e.preventDefault(),t.style.left=e.clientX-r+"px",t.style.top=e.clientY-s+"px"}function i(t){t.preventDefault(),o.removeEventListener("mouseup",i),o.removeEventListener("mousemove",n)}var o=document;rect=t.getBoundingClientRect();var r=e.clientX-rect.left,s=e.clientY-rect.top;o.addEventListener("mousemove",n,!1),o.addEventListener("mouseup",i,!1)}var o=document.getElementsByTagName("body")[0];n.createDom=function(t,e,n){n=n||o;var i=document.createElement(t);return n.appendChild(i),e&&(i.className=e),i},n.createDiv=function(t,e){return n.createDom("div",t,e)},n.removeDom=function(t,e){e=e||o,e.removeChild(t)},n.makeClickable=function(t,e){return t.addEventListener("mousedown",function(n){n.stopPropagation(),n.preventDefault(),e.call(t,n)}),t},n.makeDragable=function(t,e){return e=e||t,t.addEventListener("mousedown",function(t){t.stopPropagation(),t.preventDefault(),i(e,t)}),t}},{}],12:[function(t,e,n){function i(){this.available=!1,this.btn={},this.btnp={},this.btnr={},this.x=0,this.y=0,this.z=0,this.w=0,this.lt=0,this.rt=0,this._setupButtons()}function o(){for(var t=navigator.getGamepads(),e=0;e<4;e++){var n=t[e],i=a[e];if(n){i.available=!0;for(var o=0;o<s.length;o++){var r=s[o],u=n.buttons[o].pressed;i.btnp[r]=!i.btn[r]&&u,i.btnr[r]=i.btn[r]&&!u,i.btn[r]=u}i.x=n.axes[0],i.y=n.axes[1],i.z=n.axes[2],i.w=n.axes[3],i.lt=n.buttons[6].value,i.rt=n.buttons[7].value}else i.available=!1}return a}function r(){return a}var s=["A","B","X","Y","lb","rb","lt","rt","back","start","lp","rp","up","down","left","right"],u=!(!navigator||!navigator.getGamepads);i.prototype._setupButtons=function(){for(var t=0;t<s.length;t++){var e=s[t];this.btn[e]=!1,this.btnp[e]=!1,this.btnr[e]=!1}};var a=[new i,new i,new i,new i],h=new i;n.getGamepads=u?o:r,n.getGamepad=function(t){return t===-1?window:o()[t]},n.getAnyGamepad=function(){n.getGamepads();for(var t=0;t<s.length;t++){var e=s[t];h.btnp[e]=btnp[e]||a[0].btnp[e]||a[1].btnp[e]||a[2].btnp[e]||a[3].btnp[e],h.btnr[e]=btnr[e]||a[0].btnr[e]||a[1].btnr[e]||a[2].btnr[e]||a[3].btnr[e],h.btn[e]=btn[e]||a[0].btn[e]||a[1].btn[e]||a[2].btn[e]||a[3].btn[e]}return h}},{}],13:[function(t,e,n){e.exports=function(t,e){t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}},{}],14:[function(t,e,n){e.exports={dat:{font:null,logic:null,tilesheet:null,levels:[{id:"intro",paper:0,parallax:.9,music:"adventure"}],maps:{_type:"maps",maps:[{w:16,h:16,name:"map",sheet:"",data:"!!.q"}]},entity:{kiwii:{idle:null}}},root:"assets/",img:["font.png","logic.png","tilesheet.png","entity/kiwii/idle.png"],snd:[],settings:{name:"Kiwii",version:"2.0.0",screen:{fullscreen:!1,resizable:!1,width:256,height:240,pixelSize:{width:3,height:3}},tileSize:{width:16,height:16},palette:["#000000","#797979","#A2A2A2","#305182","#4192C3","#61D3E3","#A2FFF3","#306141","#49A269","#71E392","#A2FFCB","#386D00","#49AA10","#71F341","#A2F3A2","#386900","#51A200","#9AEB00","#CBF382","#495900","#8A8A00","#EBD320","#FFF392","#794100","#C37100","#FFA200","#FFDBA2","#A23000","#E35100","#FF7930","#FFCBBA","#B21030","#DB4161","#FF61B2","#FFBAEB","#9A2079","#DB41C3","#F361FF","#E3B2FF","#6110A2","#9241F3","#A271FF","#C3B2FF","#2800BA","#4141FF","#5182FF","#A2BAFF","#2000B2","#4161FB","#61A2FF","#92D3FF","#797979","#B2B2B2","#EBEBEB","#FFFFFF"],controls:{up:38,down:40,left:37,right:39,A:32,B:88},touchEvent:{multiTouch:!1,disableContextMenu:!1,hideMousePointer:!1},loaderColors:[0,1],components:{pixelboxCore:!0,keyboard:!0,AudioManager:!0,TINA:!1}}}},{}],15:[function(t,e,n){function i(t,e,n,i){this.w=t,this.h=e,this.paper=0,this.color=0,this.texture=new o(t,e)}var o=t("Texture"),r=8,s=8,u=32;e.exports=i,i.prototype.clear=function(){return this.texture.clear(),this},i.prototype.cls=function(){return this.texture.paper(this.paper),this.texture.cls(),this},i.prototype.draw=function(t,e){draw(this.texture,t,e)},i.prototype.addText=function(t,e,n){for(var i=0;i<t.length;i++){var o=t.charCodeAt(i),a=o-u,h=a%16,l=~~(a/16);this.texture.ctx.drawImage(assets.font,h*r,l*s,r,s,e,n,r,s),e+=r}return this},i.prototype.setColor=function(t){return this.color=t,this}},{Texture:1}],16:[function(t,e,n){function i(){l=!l,h.style.display=l?"":"none"}function o(t){r.open("game",{level:this.level}),i()}var r=t("./viewManager"),s=t("domUtils"),u=s.createDiv("panel"),a=s.createDiv("button",u),h=s.createDiv("",u),l=!1;h.style.display="none",a.innerText="+",s.makeClickable(a,i);for(var p=assets.levels,c=0;c<p.length;c++)if(!p[c].intermission){var d=s.createDiv("button",h),f=p[c].id;d.innerText=f,d.level=f,s.makeClickable(d,o)}},{"./viewManager":18,domUtils:11}],17:[function(t,e,n){var i=t("./viewManager");i.addView("title",t("./view/titleView")),i.addView("game",t("./view/gameView")),i.open("title"),n.update=i.update},{"./debug":16,"./view/gameView":19,"./view/titleView":20,"./viewManager":18}],18:[function(t,e,n){var i={};n.view=null,n.addView=function(t,e){i[t]=e},n.open=function(t,e){var o=i[t];return o?(n.view=o,void(o.open&&o.open(e))):console.error("view does not exist",t)},n.update=function(){n.view.update()}},{}],19:[function(t,e,n){t("../viewManager"),t("gamepad");n.open=function(t){},n.update=function(){}},{"../viewManager":18,gamepad:12}],20:[function(t,e,n){function i(){o.open("game")}var o=t("../viewManager"),r=t("../TextBox"),s=t("gamepad");n.open=function(){};var u=new r(200,100);u.addText("This is a test",0,0),n.update=function(){paper(4),cls(),u.draw(0,0);var t=s.getAnyGamepad();t.btnp.A&&i(),t.btnp.B&&i(),t.btnp.start&&i()}},{"../TextBox":15,"../viewManager":18,gamepad:12}],21:[function(t,e,n){function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function r(t){if(p===setTimeout)return setTimeout(t,0);if((p===i||!p)&&setTimeout)return p=setTimeout,setTimeout(t,0);try{return p(t,0)}catch(e){try{return p.call(null,t,0)}catch(e){return p.call(this,t,0)}}}function s(t){if(c===clearTimeout)return clearTimeout(t);if((c===o||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(t);try{return c(t)}catch(e){try{return c.call(null,t)}catch(e){return c.call(this,t)}}}function u(){y&&f&&(y=!1,f.length?v=f.concat(v):g=-1,v.length&&a())}function a(){if(!y){var t=r(u);y=!0;for(var e=v.length;e;){for(f=v,v=[];++g<e;)f&&f[g].run();g=-1,e=v.length}f=null,y=!1,s(t)}}function h(t,e){this.fun=t,this.array=e}function l(){}var p,c,d=e.exports={};!function(){try{p="function"==typeof setTimeout?setTimeout:i}catch(t){p=i}try{c="function"==typeof clearTimeout?clearTimeout:o}catch(t){c=o}}();var f,v=[],y=!1,g=-1;d.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];v.push(new h(t,e)),1!==v.length||y||r(a)},h.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=l,d.addListener=l,d.once=l,d.off=l,d.removeListener=l,d.removeAllListeners=l,d.emit=l,d.prependListener=l,d.prependOnceListener=l,d.listeners=function(t){return[]},d.binding=function(t){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(t){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},{}],22:[function(t,e,n){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},{}],23:[function(t,e,n){e.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},{}],24:[function(t,e,n){(function(e,i){function o(t,e){var i={seen:[],stylize:s};return arguments.length>=3&&(i.depth=arguments[2]),arguments.length>=4&&(i.colors=arguments[3]),v(e)?i.showHidden=e:e&&n._extend(i,e),_(i.showHidden)&&(i.showHidden=!1),_(i.depth)&&(i.depth=2),_(i.colors)&&(i.colors=!1),_(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=r),a(i,t,i.depth)}function r(t,e){var n=o.styles[e];return n?"["+o.colors[n][0]+"m"+t+"["+o.colors[n][1]+"m":t}function s(t,e){return t}function u(t){var e={};return t.forEach(function(t,n){e[t]=!0}),e}function a(t,e,i){if(t.customInspect&&e&&C(e.inspect)&&e.inspect!==n.inspect&&(!e.constructor||e.constructor.prototype!==e)){var o=e.inspect(i,t);return w(o)||(o=a(t,o,i)),o}var r=h(t,e);if(r)return r;var s=Object.keys(e),v=u(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(e)),T(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return l(e);if(0===s.length){if(C(e)){var y=e.name?": "+e.name:"";return t.stylize("[Function"+y+"]","special")}if(b(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(A(e))return t.stylize(Date.prototype.toString.call(e),"date");if(T(e))return l(e)}var g="",m=!1,x=["{","}"];if(f(e)&&(m=!0,x=["[","]"]),C(e)){var _=e.name?": "+e.name:"";g=" [Function"+_+"]"}if(b(e)&&(g=" "+RegExp.prototype.toString.call(e)),A(e)&&(g=" "+Date.prototype.toUTCString.call(e)),T(e)&&(g=" "+l(e)),0===s.length&&(!m||0==e.length))return x[0]+g+x[1];if(i<0)return b(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var S;return S=m?p(t,e,i,v,s):s.map(function(n){return c(t,e,i,v,n,m)}),t.seen.pop(),d(S,g,x)}function h(t,e){if(_(e))return t.stylize("undefined","undefined");if(w(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return m(e)?t.stylize(""+e,"number"):v(e)?t.stylize(""+e,"boolean"):y(e)?t.stylize("null","null"):void 0}function l(t){return"["+Error.prototype.toString.call(t)+"]"}function p(t,e,n,i,o){for(var r=[],s=0,u=e.length;s<u;++s)B(e,String(s))?r.push(c(t,e,n,i,String(s),!0)):r.push("");return o.forEach(function(o){o.match(/^\d+$/)||r.push(c(t,e,n,i,o,!0))}),r}function c(t,e,n,i,o,r){var s,u,h;if(h=Object.getOwnPropertyDescriptor(e,o)||{value:e[o]},h.get?u=h.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):h.set&&(u=t.stylize("[Setter]","special")),B(i,o)||(s="["+o+"]"),u||(t.seen.indexOf(h.value)<0?(u=y(n)?a(t,h.value,null):a(t,h.value,n-1),u.indexOf("\n")>-1&&(u=r?u.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+u.split("\n").map(function(t){return"   "+t}).join("\n"))):u=t.stylize("[Circular]","special")),_(s)){if(r&&o.match(/^\d+$/))return u;s=JSON.stringify(""+o),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+u}function d(t,e,n){var i=0,o=t.reduce(function(t,e){return i++,e.indexOf("\n")>=0&&i++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0);return o>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}function f(t){return Array.isArray(t)}function v(t){return"boolean"==typeof t}function y(t){return null===t}function g(t){return null==t}function m(t){return"number"==typeof t}function w(t){return"string"==typeof t}function x(t){return"symbol"==typeof t}function _(t){return void 0===t}function b(t){return S(t)&&"[object RegExp]"===I(t)}function S(t){return"object"==typeof t&&null!==t}function A(t){return S(t)&&"[object Date]"===I(t)}function T(t){return S(t)&&("[object Error]"===I(t)||t instanceof Error)}function C(t){return"function"==typeof t}function L(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function I(t){return Object.prototype.toString.call(t)}function M(t){return t<10?"0"+t.toString(10):t.toString(10)}function F(){var t=new Date,e=[M(t.getHours()),M(t.getMinutes()),M(t.getSeconds())].join(":");return[t.getDate(),R[t.getMonth()],e].join(" ")}function B(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var j=/%[sdj%]/g;n.format=function(t){if(!w(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(o(arguments[n]));return e.join(" ")}for(var n=1,i=arguments,r=i.length,s=String(t).replace(j,function(t){if("%%"===t)return"%";if(n>=r)return t;switch(t){case"%s":return String(i[n++]);case"%d":return Number(i[n++]);case"%j":try{return JSON.stringify(i[n++])}catch(t){return"[Circular]"}default:return t}}),u=i[n];n<r;u=i[++n])s+=y(u)||!S(u)?" "+u:" "+o(u);return s},n.deprecate=function(t,o){function r(){if(!s){if(e.throwDeprecation)throw new Error(o);e.traceDeprecation?console.trace(o):console.error(o),s=!0}return t.apply(this,arguments)}if(_(i.process))return function(){return n.deprecate(t,o).apply(this,arguments)};if(e.noDeprecation===!0)return t;var s=!1;return r};var E,P={};n.debuglog=function(t){if(_(E)&&(E=e.env.NODE_DEBUG||""),t=t.toUpperCase(),!P[t])if(new RegExp("\\b"+t+"\\b","i").test(E)){var i=e.pid;P[t]=function(){var e=n.format.apply(n,arguments);console.error("%s %d: %s",t,i,e)}}else P[t]=function(){};return P[t]},n.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=f,n.isBoolean=v,n.isNull=y,n.isNullOrUndefined=g,n.isNumber=m,n.isString=w,n.isSymbol=x,n.isUndefined=_,n.isRegExp=b,n.isObject=S,n.isDate=A,n.isError=T,n.isFunction=C,n.isPrimitive=L,n.isBuffer=t("./support/isBuffer");var R=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];n.log=function(){console.log("%s - %s",F(),n.format.apply(n,arguments))},n.inherits=t("inherits"),n._extend=function(t,e){if(!e||!S(e))return t;for(var n=Object.keys(e),i=n.length;i--;)t[n[i]]=e[n[i]];return t}}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":23,_process:21,inherits:22}],25:[function(t,e,n){function i(){for(var t=0;t<g;t++)d[y[t]]=!1,f[y[t]]=!1}function o(t,e){var n=v[t];n&&(e&&!c[n]&&(d[n]=!0),!e&&c[n]&&(f[n]=!0),c[n]=e)}function r(t,e,n){var i=new m(t,e),o=i.canvas;document.body.appendChild(o);var r=o.style;return r.width=t*(n.width||n[0])+"px",r.height=e*(n.height||n[1])+"px",i}function s(e,n){function o(){r.update(),i(),b(o)}if(paper(0).pen(1).cls(),e)return print(e),console.error(e);window.assets=n,n.tilesheet&&tilesheet(n.tilesheet),w.loadBank(n.maps);var r=t("../src/main.js");r.update&&(i(),o())}function u(t,e,n,i){rectfill(S-A,T-2,~~(i*A*2),4)}var a=t("./pbxProjectData.json");window.settings=a.settings;var h=t("assetLoader");window.inherits=t("inherits");var l=t("audio-manager"),p=window.audioManager=new l(["sfx"]);p.settings.audioPath="audio/",p.settings.defaultFade=.3,p.init(),p.setVolume("sfx",1),window.sfx=function(t,e,n,i){p.playSound("sfx",t,e,n,i)},window.music=function(t,e){return t?void p.playLoopSound("sfx",t,e):void p.stopLoopSound("sfx")};var c=window.btn={},d=window.btnp={},f=window.btnr={},v={},y=[],g=0;!function(){var t=settings.controls||{up:38,down:40,left:37,right:39,A:32,B:88};for(var e in t){var n=t[e];v[n]=e,c[e]=!1,d[e]=!1,f[e]=!1,y.push(e)}g=y.length}(),window.addEventListener("keydown",function(t){t.preventDefault(),o(t.keyCode,!0)}),window.addEventListener("keyup",function(t){t.preventDefault(),o(t.keyCode,!1)}),window.chr$=function(t){return String.fromCharCode(t)},window.clip=function(t,e,n){return Math.max(e,Math.min(n,t))},window.random=function(t){return~~(t*Math.random())};var m=t("Texture"),w=t("TileMap");window.texture=function(t){var e=new m(t.width,t.height);return e.ctx.drawImage(t,0,0),e},window.tilesheet=function(t){return m.prototype.setGlobalTilesheet(t)};var x=window.$screen=r(settings.screen.width,settings.screen.height,settings.screen.pixelSize);x.setPalette(settings.palette),window.cls=function(){return x.cls()},window.sprite=function(t,e,n,i,o,r){return x.sprite(t,e,n,i,o,r)},window.draw=function(t,e,n,i,o,r){return x.draw(t,e,n,i,o,r)},window.rect=function(t,e,n,i){return x.rect(t,e,n,i)},window.rectfill=function(t,e,n,i){return x.rectfill(t,e,n,i)},window.camera=function(t,e){return x.setCamera(t,e)},window.pen=function(t){return x.pen(t)},window.paper=function(t){return x.paper(t)},window.locate=function(t,e){return x.locate(t,e)},window.print=function(t,e,n){return x.print(t,e,n)},window.println=function(t){return x.println(t)},window.getMap=w.getMap;var _=1/60,b=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,_)},S=~~(settings.screen.width/2),A=~~(settings.screen.width/4),T=~~(settings.screen.height/2),C=settings.loaderColors||[0,1];Array.isArray(C)||(C=[0,1]);var L=~~C[0],I=~~C[1];paper(L).cls().paper(I).pen(I),rect(S-A-2,T-4,2*A+4,8),h.preloadStaticAssets(a,s,u)},{"../src/main.js":17,"./pbxProjectData.json":14,Texture:1,TileMap:2,assetLoader:3,"audio-manager":5,inherits:13}]},{},[25]);